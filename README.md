# Definer — самая простая модульная система для JavaScript на клиенте

Definer предназначен для удобной разработки. С его помощью можно использовать модули и указывать их зависимости, по которым в дальнейшем будет выполнена сборка. В результирующем файле не будет модульной системы, поэтому конечный пользователь не получит лишний код, реализующий модули.

## Использование

### Установка

    npm install definer

### Подключение

Достаточно подключить [один файл](https://github.com/tenorok/definer/blob/master/definer.js).
```html
<script src="definer.js"></script>
```

### Объявление модулей

Пусть есть модули `a` и `b`, и модуль `c`, зависящий от них.

```javascript
var a = define('a', function() { return 'a'; }); // a
var b = define('b', function() { return 'b'; }); // b
var c = define('c', function(a, b) { return a + b + 'c'; }); //abc
```

Модули должны быть объявлены в правильной последовательности, иначе возникнет ошибка.

```javascript
define('b', function(a) {}); // ReferenceError: module a is not defined
define('a', function() {});
```

### Экспорт в глобальный контекст

Внутри модулей `this` указывает на глобальный контекст. Используя это, модуль может легко экспортировать данные.

```javascript
define('d', function() { this.d = 'd'; }); // Появилась глобальная переменная d
```

### Сборка

Представим, что имеется следующая файловая структура:

```
modules/
    sub/c.js
    a.js
    b.js
```

Находясь в директории `modules` для сборки проекта достаточно выполнить одну команду.

    ./node_modules/.bin/definer all.js

В процессе сборки definer выполнит рекурсивный поиск модулей в файлах `*.js` текущей директории и собранный результат будет сохранён в файл `all.js`:

```javascript
(function(global) {
var a = (function () { return 'a'; }).call(global),
    b = (function () { return 'b'; }).call(global),
    c = (function (a, b) { return a + b + 'c'; }).call(global, a, b);
})(this);
```

#### Опции сборки

По имеющимся опциям можно получить краткую справку прямо в терминале.

    ./node_modules/.bin/definer --help

##### Опция `-d, --directory`

Опция указывает откуда следует начать искать модули в файловой системе. Поиск модулей выполняется рекурсивно по всем вложенным директориям.

    ./node_modules/.bin/definer -d modules/ all.js

По умолчанию definer ищет модули в текущей директории.

##### Опция `-p, --postfix`

Опция задаёт постфикс файлов, в которых будет производиться поиск модулей.

    ./node_modules/.bin/definer -p module.js all.js

По умолчанию опции установлено значение `js`.

##### Опция `-m, --module`

Опция позволяет указать имя модуля, для которого необходимо выполнить сборку. В результирующий файл попадут только те модули, которые необходимы для указанного модуля.

    ./node_modules/.bin/definer -m c all.js

По умолчанию собираются все найденные модули.
